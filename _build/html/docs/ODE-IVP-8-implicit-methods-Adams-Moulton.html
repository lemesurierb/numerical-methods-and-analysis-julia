
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>7.9. Implicit Methods: Adams-Moulton &#8212; Introduction to Numerical Methods and Analysis with Julia (draft)</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="8. Bibliography" href="bibliography.html" />
    <link rel="prev" title="7.8. Adams-Bashforth Multistep Methods" href="ODE-IVP-7-multi-step-methods-Adams-Bashforth.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/WM_SSM_new_logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Introduction to Numerical Methods and Analysis with Julia (draft)</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Preface
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="introduction.html">
   1. Introduction
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="root-finding.html">
   2. Root-finding
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="root-finding-by-interval-halving.html">
     2.1. Root Finding by Interval Halving (Bisection)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="fixed-point-iteration.html">
     2.2. Solving Equations by Fixed Point Iteration (of Contraction Mappings)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="newtons-method.html">
     2.3. Newton’s Method for Solving Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="taylors-theorem.html">
     2.4. Taylor’s Theorem and the Accuracy of Linearization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="error-measures-convergence-rates.html">
     2.5. Measures of Error and Order of Convergence
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="newtons-method-convergence-rate.html">
     2.6. The Convergence Rate of Newton’s Method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="root-finding-without-derivatives.html">
     2.7. Root-finding without Derivatives
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="linear-algebra.html">
   3. Linear Algebra and Simultaneous Equations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="linear-equations-1-row-reduction.html">
     3.1. Row Reduction/Gaussian Elimination
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="machine-numbers-rounding-error-and-error-propagation.html">
     3.2. Machine Numbers, Rounding Error and Error Propagation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear-equations-2-pivoting.html">
     3.3. Partial Pivoting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear-equations-3-lu-factorization.html">
     3.4. Solving
     <span class="math notranslate nohighlight">
      \(Ax = b\)
     </span>
     with LU factorization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear-equations-4-plu-factorization.html">
     3.5. Solving
     <span class="math notranslate nohighlight">
      \(Ax = b\)
     </span>
     With Both Pivoting and LU Factorization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear-equations-5-error-bounds-condition-numbers.html">
     3.6. Error bounds for linear algebra, condition numbers, matrix norms, etc.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear-equations-6-iterative-methods.html">
     3.7. Iterative Methods for Simultaneous Linear Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear-equations-7-tridiagonal-banded-and-SDD-matrices.html">
     3.8. Faster Methods for Solving
     <span class="math notranslate nohighlight">
      \(Ax = b\)
     </span>
     for Tridiagonal and Banded matrices, and Strict Diagonal Dominance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="eigenproblems.html">
     3.9. Computing Eigenvalues and Eigenvectors: the Power Method, and a bit beyond
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="newtons-method-for-systems-intro.html">
     3.10. Solving Nonlinear Systems of Equations by generalizations of Newton’s Method — a brief introduction
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="collocation-approximation.html">
   4. Polynomial Collocation and Approximation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="polynomial-collocation%2Bapproximation.html">
     4.1. Polynomial Collocation (Interpolation/Extrapolation) and Approximation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="polynomial-collocation-error-formulas.html">
     4.2. Error Formulas for Polynomial Collocation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="polynomial-collocation-chebychev.html">
     4.3. Choosing the collocation points: the Chebyshev method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="piecewise-polynomial-approximation-and-splines.html">
     4.4. Piecewise Polynomial Approximating Functions: Splines and Hermite Cubics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="least-squares-fitting.html">
     4.5. Least-Squares Fitting to Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="least-squares-fitting-appendix-geometrical-approach.html">
     4.6. Least-squares Fitting to Data: Appendix on The Geometrical Approach
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="calculus.html">
   5. Derivatives and Definite Integrals
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="derivatives-and-the-method-of-undetermined-coefficents.html">
     5.1. Approximating Derivatives by the Method of Undetermined Coefficients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="richardson-extrapolation.html">
     5.2. Richardson Extrapolation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integrals-1-building-blocks.html">
     5.3. Definite Integrals, Part 1: The Building Blocks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integrals-2-composite-rules.html">
     5.4. Definite Integrals, Part 2: The Composite Trapezoid and Midpoint Rules
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integrals-3-simpson-richardson.html">
     5.5. Definite Integrals, Part 3: The (Composite) Simpson’s Rule and Richardson Extrapolation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integrals-4-romberg-integration.html">
     5.6. Definite Integrals, Part 4: Romberg Integration
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="minimization.html">
   6. Minimization
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="minimization-1D.html">
     6.1. Finding the Minimum of a Function of One Variable Without Using Derivatives – under construction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="minimization-multidimensional-stub.html">
     6.2. Finding the Minimum of a Function of Several Variables — Coming Soon
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="ODE-IVPs.html">
   7. Initial Value Problems for Ordinary Differential Equations
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="ODE-IVP-0-background-examples.html">
     7.1. Background and Some Examples
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ODE-IVP-1-Euler.html">
     7.2. Euler’s Method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ODE-IVP-2-Runge-Kutta.html">
     7.3. Runge-Kutta Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ODE-IVP-3-error-results-one-step-methods.html">
     7.4. A Global Error Bound for One Step Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ODE-IVP-4-system-higher-order-equations.html">
     7.5. Systems of ODEs and Higher Order ODEs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ODE-IVP-5-error-control.html">
     7.6. Error Control and Variable Step Sizes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ODE-IVP-6-multi-step-methods-introduction.html">
     7.7. An Introduction to Multistep Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ODE-IVP-7-multi-step-methods-Adams-Bashforth.html">
     7.8. Adams-Bashforth Multistep Methods
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     7.9. Implicit Methods: Adams-Moulton
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bibliography.html">
   8. Bibliography
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="appendices.html">
   9. Appendices
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="installing-julia-and-packages.html">
     9.1. Installing Julia and some useful add-ons
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="julia-language-notes.html">
     9.2. Notes on the Julia Language
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="NumericalMethods.html">
     9.3. Module
     <code class="docutils literal notranslate">
      <span class="pre">
       NumericalMethods
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/ODE-IVP-8-implicit-methods-Adams-Moulton.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/docs/ODE-IVP-8-implicit-methods-Adams-Moulton.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compare-to-the-explicit-trapezoid-method">
     Compare to the explicit trapezoid method
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Implicit Methods: Adams-Moulton</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compare-to-the-explicit-trapezoid-method">
     Compare to the explicit trapezoid method
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="implicit-methods-adams-moulton">
<h1><span class="section-number">7.9. </span>Implicit Methods: Adams-Moulton<a class="headerlink" href="#implicit-methods-adams-moulton" title="Permalink to this headline">#</a></h1>
<p><strong>References:</strong></p>
<ul class="simple">
<li><p>Section 6.7 <em>Multistep Methods</em> in <span id="id1">[<a class="reference internal" href="bibliography.html#id4" title="Timothy Sauer. Numerical Analysis. Pearson, 3rd edition, 2019.">Sauer, 2019</a>]</span>.</p></li>
<li><p>Section 5.6 <em>Multistep Methods</em> in <span id="id2">[<a class="reference internal" href="bibliography.html#id5" title="Richard L. Burden, J. Douglas Faires, and Annette M. Burden. Numerical Analysis. Cengage, 10th edition, 2016.">Burden <em>et al.</em>, 2016</a>]</span>.</p></li>
</ul>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p>So far, most methods we have seen give the new approximation value with an explicit formula for it in terms of previous and so already known) values;
the general <strong>explicit s-step method</strong> seen in
<a class="reference internal" href="ODE-IVP-7-multi-step-methods-Adams-Bashforth.html"><span class="doc">Adams-Bashforth Multistep Methods</span></a>
was</p>
<div class="math notranslate nohighlight">
\[U_{i} = \phi(U_{i-1}, \dots U_{i-s+}, h), \quad s &gt; 1\]</div>
<p>However, we briefly saw two <strong>implict methods</strong> back in <a class="reference internal" href="ODE-IVP-2-Runge-Kutta.html"><span class="doc">Runge-Kutta Methods</span></a>,
in the process of deriving the explicit trapezoid and explicit midpoint methods:
the <strong>Implicit Trapezoid Method</strong> (or just the <strong>Trapezoid Method</strong>, as this is the real thing, before the further approximations were used to get an explicit formula)</p>
<div class="math notranslate nohighlight">
\[U_{i+1} = U_i + h \frac{f(t_i, U_i) + f(t_{i+1}, U_{i+1}))}{2}\]</div>
<p>and the <strong>Implicit Midpoint Method</strong></p>
<div class="math notranslate nohighlight">
\[U_{i+1} = U_i + h f\left( t + h/2, \frac{U_i + U_{i+1}}{2} \right)\]</div>
<p>These are clearly not as simple to work with as explicit methods, but the equation solving can often be done.
In particular for linear differential equations, these give linear equations for the unknown <span class="math notranslate nohighlight">\(U_{i+1}\)</span>, so even for systems,
they can be solved by the method seen earlier in these notes.</p>
<p>Another strategy is noting that these are fixed point equations, so that fixed point iteration can be used.
The factor <span class="math notranslate nohighlight">\(h\)</span> at right helps; it can be shown that for small enough <span class="math notranslate nohighlight">\(h\)</span> (how small depends on the function <span class="math notranslate nohighlight">\(f\)</span>),
these are contraction mappings and so fixed point iteration works.</p>
<p>This idea can be combined with linear multistep methods, and one important case is modifying the Adams-Bashforth method by allowing
<span class="math notranslate nohighlight">\(F_i = f(t_i, U_i)\)</span> to appear at right: this gives the Adams-Moulton form</p>
<div class="math notranslate nohighlight">
\[U_{i} = U_{i-1} + h (b_0 f(t_{i-s}, U_{i-s}) + \dots + b_{s} f(t_{i}, U_{i}))\]</div>
<p>where the only change from Adams-Bashforth methods is that <span class="math notranslate nohighlight">\(f(t_{i}, U_{i})\)</span> term.</p>
<p>The coefficients can be derived much as for Adams-Bashforth methods, by the method of undetermined coefficients;
one valuable difference is that there at now <span class="math notranslate nohighlight">\(s+1\)</span> undetermined coefficients, so all error terms up to <span class="math notranslate nohighlight">\(O(h^s)\)</span> can be cancelled
and the error made <span class="math notranslate nohighlight">\(O(h^{s+1})\)</span>: one degree higher.</p>
<p>The <span class="math notranslate nohighlight">\(s=1\)</span> case is familiar:</p>
<div class="math notranslate nohighlight">
\[U_{i} = U_{i-1} + h (b_0 f(t_{i-1}, U_{i-1}) + b_{1} f(t_{i}, U_{i}))\]</div>
<p>and as symmetry suggests, the solution is <span class="math notranslate nohighlight">\(b_0 = b_1 = 1/2\)</span>, giving</p>
<div class="math notranslate nohighlight">
\[U_{i} = U_{i-1} + h \frac{f(t_{i-1}, U_{i-1}) + f(t_{i}, U_{i})}{2}\]</div>
<p>which is the (implicit) trapzoid rule in the new shifted indexing.</p>
<p>This is much used for numerical solution of partial differential equations of evoluton type (after first approximating by a large system of ordinary differnetial equations).
In that context it is often known as the <strong>Crank-Nicholson method</strong>.</p>
<p>We can actually start at <span class="math notranslate nohighlight">\(s=0\)</span>; the first few Adams-Moulton methods are:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
s = 0: b_0 &amp;= 1
\\
 &amp;U_{i} - h f(t_i, U_i)) = U_{i-1} \qquad &amp;\text{The backward Euler method}
\\
s = 1: b_0 &amp;= b_1 = 1/2
\\
 &amp;U_{i} - \frac{h}{2} f(t_i, U_i) = U_{i-1} + \frac{h}{2} (F_{i-1} ) \qquad &amp;\text{The (implicit) trapezoid method}
\\
s = 2: b_0 &amp;= -1/12, b_1 = 8/12, b_2 = 5/12
\\
&amp;U_{i} - \frac{5h}{12}f(t_i, U_i) = U_{i-1} + \frac{h}{12} (-F_{i-2} + 8 F_{i-1})
\\
s = 3: b_0 &amp;= 1/24, b_1 = -5/24, b_2 = 19/24, b_3 = 9/24
\\
&amp;U_{i} - \frac{9h}{24}f(t_i, U_i) = U_{i-1} + \frac{h}{24}(F_{i-3} -5F_{i-2} + 19F_{i-1})
\end{align*}\]</div>
<p>The use of <span class="math notranslate nohighlight">\(F_{i-k}\)</span> notation emphasizes that these earlier values of <span class="math notranslate nohighlight">\(F_{i-k} = f(t_{i-k}, U_{i-k})\)</span> are known from a previous step,
so can be stored for reuse.</p>
<p>The backward Euler method has not been mentioned before; it comes from using the backward counterpart of the forward difference approximation of the derivative:</p>
<div class="math notranslate nohighlight">
\[u'(t) \approx \frac{u(t) - u(t-h)}{h}\]</div>
<p>Like Euler’s method it is only first order accurate, but it has excellent <em>stability</em> properties, which makes it useful in some situations.</p>
<div class="proof example admonition" id="example-0">
<p class="admonition-title"><span class="caption-number">Example 7.10 </span> (An equation with fast and slow time scales)</p>
<section class="example-content" id="proof-content">
<p>The equation</p>
<div class="math notranslate nohighlight">
\[ y'' + 101 y' + 100y = 0, \quad y(0) = y_0, y'(0) = v_0 \]</div>
<p>has the general solution</p>
<div class="math notranslate nohighlight">
\[ y(t) = A e^{-t} + B e^{-100t} \]</div>
<p>With explicit methods, the time-step size has to be smal enought to resove the fast time scale, so <span class="math notranslate nohighlight">\(h\)</span> of order <span class="math notranslate nohighlight">\(1/100\)</span>,
but the second term decays very rapdly, and with some equations like this it is enough to resolve the dominant behavior of the <span class="math notranslate nohighlight">\(e^{-t}\)</span> term,
which some implict method can resolve with far larger step sizes.</p>
<p>Let us compare how this is handled by the implicit trapezoid and explicit trapezoid methods.</p>
</section>
</div><p>The system form is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\frac{d}{dt} \left[\begin{array}{c} u_1 \\ u_2 \end{array}\right] =
\left[\begin{array}{cc} 0 &amp; 1 \\ -100 &amp; -101 \end{array}\right] \left[\begin{array}{c} u_1 \\ u_2 \end{array}\right]
\end{split}\]</div>
<p>The trapezoid method is thus</p>
<div class="math notranslate nohighlight">
\[\begin{split}
U_i - \frac{h}{2}\left[\begin{array}{cc} 0 &amp; 1 \\ -100 &amp; -101 \end{array}\right] U_i =
U_{i-1} + \frac{h}{2}\left[\begin{array}{cc} 0 &amp; 1 \\ -100 &amp; -101 \end{array}\right]
\end{split}\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\left[\begin{array}{cc} 1 &amp; -h/2 \\ 50h &amp; 1 + 101h/2 \end{array}\right] U_i
=
\left[\begin{array}{cc} 1 &amp; h/2 \\ -50h &amp; 1 - 101h/2 \end{array}\right] U_{i-1}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="n">PyPlot</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">include</span><span class="p">(</span><span class="s">&quot;NumericalMethods.jl&quot;</span><span class="p">)</span>
<span class="k">using</span> <span class="o">.</span><span class="n">NumericalMethods</span><span class="o">:</span> <span class="n">explicittrapezoid_system</span><span class="p">,</span> <span class="n">approx3</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span> <span class="n">f_fast_slow</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="o">-</span><span class="n">K</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
<span class="k">end</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span> <span class="n">y_fast_slow</span><span class="p">(</span><span class="n">t</span><span class="p">;</span> <span class="n">t_0</span><span class="p">,</span> <span class="n">y_0</span><span class="p">,</span> <span class="n">v_0</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
    <span class="n">B</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">y_0</span> <span class="o">+</span> <span class="n">v_0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">y_0</span> <span class="o">-</span> <span class="n">B</span>
    <span class="k">return</span> <span class="n">A</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">t_0</span><span class="p">))</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">K</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">t_0</span><span class="p">))</span>
<span class="k">end</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="o">=</span> <span class="mf">100.0</span>
<span class="n">y_0</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">v_0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">u_0</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_0</span><span class="p">;</span> <span class="n">v_0</span><span class="p">]</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">b</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">200</span>  <span class="c"># explicit trapezoid works</span>
<span class="c">#n = 50  # explicit trapezoid works, barely</span>

<span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">range</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">)</span>   <span class="p">(</span><span class="o">-</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
     <span class="p">(</span><span class="mi">50</span><span class="n">h</span><span class="p">)</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">101</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span>
<span class="n">N</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">)</span>    <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
     <span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="n">h</span><span class="p">)</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">101</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">U</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">:</span><span class="p">]</span> <span class="o">=</span> <span class="n">u_0</span>
<span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="o">:</span><span class="n">n</span>
    <span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="o">:</span><span class="p">]</span> <span class="o">=</span> <span class="n">M</span><span class="o">\</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="o">:</span><span class="p">])</span>
<span class="k">end</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y_fast_slow</span><span class="o">.</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t_0</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">y_0</span><span class="o">=</span><span class="n">y_0</span><span class="p">,</span> <span class="n">v_0</span><span class="o">=</span><span class="n">v_0</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="n">K</span><span class="p">)</span>
<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;With K=</span><span class="si">$K</span><span class="s">, by trapezoid with step size h=</span><span class="si">$</span><span class="p">(</span><span class="n">approx3</span><span class="p">(</span><span class="n">h</span><span class="p">))</span><span class="s">&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;y computed&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;exact solution&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>

<span class="n">Yerror</span> <span class="o">=</span> <span class="n">y</span><span class="o">-</span><span class="n">Y</span>
<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;Error&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Yerror</span><span class="p">)</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>

<span class="n">n_middle</span> <span class="o">=</span> <span class="n">n</span> <span class="o">÷</span> <span class="mi">2</span>
<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;Error, second half&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">n_middle</span><span class="o">:</span><span class="n">end</span><span class="p">],</span> <span class="n">Yerror</span><span class="p">[</span><span class="n">n_middle</span><span class="o">:</span><span class="n">end</span><span class="p">])</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ODE-IVP-8-implicit-methods-Adams-Moulton_20_0.png" src="../_images/ODE-IVP-8-implicit-methods-Adams-Moulton_20_0.png" />
<img alt="../_images/ODE-IVP-8-implicit-methods-Adams-Moulton_20_1.png" src="../_images/ODE-IVP-8-implicit-methods-Adams-Moulton_20_1.png" />
<img alt="../_images/ODE-IVP-8-implicit-methods-Adams-Moulton_20_2.png" src="../_images/ODE-IVP-8-implicit-methods-Adams-Moulton_20_2.png" />
</div>
</div>
<section id="compare-to-the-explicit-trapezoid-method">
<h3>Compare to the explicit trapezoid method<a class="headerlink" href="#compare-to-the-explicit-trapezoid-method" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">t_ET</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span> <span class="o">=</span> <span class="n">explicittrapezoid_system</span><span class="p">(</span><span class="n">f_fast_slow</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">u_0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y_fast_slow</span><span class="o">.</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t_0</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">y_0</span><span class="o">=</span><span class="n">y_0</span><span class="p">,</span> <span class="n">v_0</span><span class="o">=</span><span class="n">v_0</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="n">K</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;With K=</span><span class="si">$K</span><span class="s">, by explicit trapezoid with step size h=</span><span class="si">$</span><span class="p">(</span><span class="n">approx3</span><span class="p">(</span><span class="n">h</span><span class="p">))</span><span class="s">&quot;</span><span class="p">)</span>

<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;y computed&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;exact solution&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>

<span class="n">yerror</span> <span class="o">=</span> <span class="n">y</span><span class="o">-</span><span class="n">Y</span>
<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;Error&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">yerror</span><span class="p">)</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>

<span class="n">n_middle</span> <span class="o">=</span> <span class="n">n</span> <span class="o">÷</span> <span class="mi">2</span>
<span class="n">t_secondhalf</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">n_middle</span><span class="o">:</span><span class="n">end</span><span class="p">]</span>
<span class="n">yerror_secondhalf</span> <span class="o">=</span> <span class="n">yerror</span><span class="p">[</span><span class="n">n_middle</span><span class="o">:</span><span class="n">end</span><span class="p">]</span>
<span class="n">yerrormin</span> <span class="o">=</span> <span class="n">minimum</span><span class="p">([</span><span class="n">minimum</span><span class="p">(</span><span class="n">yerror_secondhalf</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">])</span><span class="o">*</span><span class="mf">1.1</span>
<span class="n">yerrormax</span> <span class="o">=</span> <span class="n">maximum</span><span class="p">([</span><span class="n">maximum</span><span class="p">(</span><span class="n">yerror_secondhalf</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">])</span><span class="o">*</span><span class="mf">1.1</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;Error, second half&quot;</span><span class="p">)</span>
<span class="n">ylim</span><span class="p">(</span><span class="n">yerrormin</span><span class="p">,</span> <span class="n">yerrormax</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t_secondhalf</span><span class="p">,</span> <span class="n">yerror_secondhalf</span><span class="p">)</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ODE-IVP-8-implicit-methods-Adams-Moulton_22_0.png" src="../_images/ODE-IVP-8-implicit-methods-Adams-Moulton_22_0.png" />
<img alt="../_images/ODE-IVP-8-implicit-methods-Adams-Moulton_22_1.png" src="../_images/ODE-IVP-8-implicit-methods-Adams-Moulton_22_1.png" />
<img alt="../_images/ODE-IVP-8-implicit-methods-Adams-Moulton_22_2.png" src="../_images/ODE-IVP-8-implicit-methods-Adams-Moulton_22_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">48</span>  <span class="c"># explicit trapezoid fails</span>

<span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">range</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">)</span>   <span class="p">(</span><span class="o">-</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
     <span class="p">(</span><span class="mi">50</span><span class="n">h</span><span class="p">)</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">101</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span>
<span class="n">N</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">)</span>    <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
     <span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="n">h</span><span class="p">)</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">101</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">U</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">:</span><span class="p">]</span> <span class="o">=</span> <span class="n">u_0</span>
<span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="o">:</span><span class="n">n</span>
    <span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="o">:</span><span class="p">]</span> <span class="o">=</span> <span class="n">M</span><span class="o">\</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="o">:</span><span class="p">])</span>
<span class="k">end</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y_fast_slow</span><span class="o">.</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t_0</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">y_0</span><span class="o">=</span><span class="n">y_0</span><span class="p">,</span> <span class="n">v_0</span><span class="o">=</span><span class="n">v_0</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="n">K</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;K=</span><span class="si">$K</span><span class="s">, by trapezoid with step size h=</span><span class="si">$</span><span class="p">(</span><span class="n">approx3</span><span class="p">(</span><span class="n">h</span><span class="p">))</span><span class="s">&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;y computed&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;exact solution&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>

<span class="n">Yerror</span> <span class="o">=</span> <span class="n">y</span><span class="o">-</span><span class="n">Y</span>
<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;Error&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Yerror</span><span class="p">)</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>

<span class="n">n_middle</span> <span class="o">=</span> <span class="n">n</span> <span class="o">÷</span> <span class="mi">2</span>
<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;Error, second half&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">n_middle</span><span class="o">:</span><span class="n">end</span><span class="p">],</span> <span class="n">Yerror</span><span class="p">[</span><span class="n">n_middle</span><span class="o">:</span><span class="n">end</span><span class="p">])</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ODE-IVP-8-implicit-methods-Adams-Moulton_23_0.png" src="../_images/ODE-IVP-8-implicit-methods-Adams-Moulton_23_0.png" />
<img alt="../_images/ODE-IVP-8-implicit-methods-Adams-Moulton_23_1.png" src="../_images/ODE-IVP-8-implicit-methods-Adams-Moulton_23_1.png" />
<img alt="../_images/ODE-IVP-8-implicit-methods-Adams-Moulton_23_2.png" src="../_images/ODE-IVP-8-implicit-methods-Adams-Moulton_23_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">t_ET</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span> <span class="o">=</span> <span class="n">explicittrapezoid_system</span><span class="p">(</span><span class="n">f_fast_slow</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">u_0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y_fast_slow</span><span class="o">.</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t_0</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">y_0</span><span class="o">=</span><span class="n">y_0</span><span class="p">,</span> <span class="n">v_0</span><span class="o">=</span><span class="n">v_0</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="n">K</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;With K=</span><span class="si">$K</span><span class="s">, by explicit trapezoid with step size h=</span><span class="si">$</span><span class="p">(</span><span class="n">approx3</span><span class="p">(</span><span class="n">h</span><span class="p">))</span><span class="s">&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;y computed&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;exact solution&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>

<span class="n">yerror</span> <span class="o">=</span> <span class="n">y</span><span class="o">-</span><span class="n">Y</span>
<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;Error&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">yerror</span><span class="p">)</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>

<span class="n">n_middle</span> <span class="o">=</span> <span class="n">n</span> <span class="o">÷</span> <span class="mi">2</span>
<span class="n">t_secondhalf</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">n_middle</span><span class="o">:</span><span class="n">end</span><span class="p">]</span>
<span class="n">yerror_secondhalf</span> <span class="o">=</span> <span class="n">yerror</span><span class="p">[</span><span class="n">n_middle</span><span class="o">:</span><span class="n">end</span><span class="p">]</span>
<span class="n">yerrormin</span> <span class="o">=</span> <span class="n">minimum</span><span class="p">([</span><span class="n">minimum</span><span class="p">(</span><span class="n">yerror_secondhalf</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">])</span><span class="o">*</span><span class="mf">1.1</span>
<span class="n">yerrormax</span> <span class="o">=</span> <span class="n">maximum</span><span class="p">([</span><span class="n">maximum</span><span class="p">(</span><span class="n">yerror_secondhalf</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">])</span><span class="o">*</span><span class="mf">1.1</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;Error, second half&quot;</span><span class="p">)</span>
<span class="n">ylim</span><span class="p">(</span><span class="n">yerrormin</span><span class="p">,</span> <span class="n">yerrormax</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t_secondhalf</span><span class="p">,</span> <span class="n">yerror_secondhalf</span><span class="p">)</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ODE-IVP-8-implicit-methods-Adams-Moulton_24_0.png" src="../_images/ODE-IVP-8-implicit-methods-Adams-Moulton_24_0.png" />
<img alt="../_images/ODE-IVP-8-implicit-methods-Adams-Moulton_24_1.png" src="../_images/ODE-IVP-8-implicit-methods-Adams-Moulton_24_1.png" />
<img alt="../_images/ODE-IVP-8-implicit-methods-Adams-Moulton_24_2.png" src="../_images/ODE-IVP-8-implicit-methods-Adams-Moulton_24_2.png" />
</div>
</div>
<div class="proof example admonition" id="ode-ivp-7-2">
<p class="admonition-title"><span class="caption-number">Example 7.11 </span> (Comparing 4th order methods: Adams-Moulton vs Runge-Kutta (coming soon))</p>
<section class="example-content" id="proof-content">
<p>Implementing the <span class="math notranslate nohighlight">\(s=3\)</span> case above, which is fourth order accurate, and compare it to the classical Runge-Kutta method <a class="reference internal" href="ODE-IVP-2-Runge-Kutta.html#runge-kutta">Algorithm 7.3</a>.</p>
</section>
</div><p>Rather than implementing any of these in general, the next section introduces a strategy for converting these to explicit methods,
much as in section <a class="reference internal" href="ODE-IVP-2-Runge-Kutta.html"><span class="doc">Runge-Kutta Methods</span></a>
Euler’s method (Adams-Bashforth <span class="math notranslate nohighlight">\(s=1\)</span>) was combined with the trapezoid method (Adams-Moulton <span class="math notranslate nohighlight">\(s=1\)</span>) to get the explicit trapozoid method:
an explicit method with the same order of accuracy as the latter of this pair.</p>
</section>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">#</a></h2>
<p>Coming soon.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "julia-1.8"
        },
        kernelOptions: {
            kernelName: "julia-1.8",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'julia-1.8'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="ODE-IVP-7-multi-step-methods-Adams-Bashforth.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">7.8. </span>Adams-Bashforth Multistep Methods</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="bibliography.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">8. </span>Bibliography</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Brenton LeMesurier (College of Charleston, South Carolina) with contributions from Stephen Roberts (Australian National University).<br/>
  
      &copy; Copyright 2021–2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>