
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>7.8. Adams-Bashforth Multistep Methods &#8212; Introduction to Numerical Methods and Analysis with Julia (draft)</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="7.9. Implicit Methods: Adams-Moulton" href="ODE-IVP-8-implicit-methods-Adams-Moulton.html" />
    <link rel="prev" title="7.7. An Introduction to Multistep Methods" href="ODE-IVP-6-multi-step-methods-introduction.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/WM_SSM_new_logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Introduction to Numerical Methods and Analysis with Julia (draft)</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Preface
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="introduction.html">
   1. Introduction
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="root-finding.html">
   2. Root-finding
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="root-finding-by-interval-halving.html">
     2.1. Root Finding by Interval Halving (Bisection)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="fixed-point-iteration.html">
     2.2. Solving Equations by Fixed Point Iteration (of Contraction Mappings)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="newtons-method.html">
     2.3. Newton’s Method for Solving Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="taylors-theorem.html">
     2.4. Taylor’s Theorem and the Accuracy of Linearization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="error-measures-convergence-rates.html">
     2.5. Measures of Error and Order of Convergence
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="newtons-method-convergence-rate.html">
     2.6. The Convergence Rate of Newton’s Method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="root-finding-without-derivatives.html">
     2.7. Root-finding without Derivatives
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="linear-algebra.html">
   3. Linear Algebra and Simultaneous Equations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="linear-equations-1-row-reduction.html">
     3.1. Row Reduction/Gaussian Elimination
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="machine-numbers-rounding-error-and-error-propagation.html">
     3.2. Machine Numbers, Rounding Error and Error Propagation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear-equations-2-pivoting.html">
     3.3. Partial Pivoting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear-equations-3-lu-factorization.html">
     3.4. Solving
     <span class="math notranslate nohighlight">
      \(Ax = b\)
     </span>
     with LU factorization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear-equations-4-plu-factorization.html">
     3.5. Solving
     <span class="math notranslate nohighlight">
      \(Ax = b\)
     </span>
     With Both Pivoting and LU Factorization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear-equations-5-error-bounds-condition-numbers.html">
     3.6. Error bounds for linear algebra, condition numbers, matrix norms, etc.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear-equations-6-iterative-methods.html">
     3.7. Iterative Methods for Simultaneous Linear Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear-equations-7-tridiagonal-banded-and-SDD-matrices.html">
     3.8. Faster Methods for Solving
     <span class="math notranslate nohighlight">
      \(Ax = b\)
     </span>
     for Tridiagonal and Banded matrices, and Strict Diagonal Dominance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="eigenproblems.html">
     3.9. Computing Eigenvalues and Eigenvectors: the Power Method, and a bit beyond
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="newtons-method-for-systems-intro.html">
     3.10. Solving Nonlinear Systems of Equations by generalizations of Newton’s Method — a brief introduction
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="collocation-approximation.html">
   4. Polynomial Collocation and Approximation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="polynomial-collocation%2Bapproximation.html">
     4.1. Polynomial Collocation (Interpolation/Extrapolation) and Approximation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="polynomial-collocation-error-formulas.html">
     4.2. Error Formulas for Polynomial Collocation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="polynomial-collocation-chebychev.html">
     4.3. Choosing the collocation points: the Chebyshev method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="piecewise-polynomial-approximation-and-splines.html">
     4.4. Piecewise Polynomial Approximating Functions: Splines and Hermite Cubics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="least-squares-fitting.html">
     4.5. Least-Squares Fitting to Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="least-squares-fitting-appendix-geometrical-approach.html">
     4.6. Least-squares Fitting to Data: Appendix on The Geometrical Approach
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="calculus.html">
   5. Derivatives and Definite Integrals
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="derivatives-and-the-method-of-undetermined-coefficents.html">
     5.1. Approximating Derivatives by the Method of Undetermined Coefficients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="richardson-extrapolation.html">
     5.2. Richardson Extrapolation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integrals-1-building-blocks.html">
     5.3. Definite Integrals, Part 1: The Building Blocks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integrals-2-composite-rules.html">
     5.4. Definite Integrals, Part 2: The Composite Trapezoid and Midpoint Rules
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integrals-3-simpson-richardson.html">
     5.5. Definite Integrals, Part 3: The (Composite) Simpson’s Rule and Richardson Extrapolation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integrals-4-romberg-integration.html">
     5.6. Definite Integrals, Part 4: Romberg Integration
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="minimization.html">
   6. Minimization
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="minimization-1D.html">
     6.1. Finding the Minimum of a Function of One Variable Without Using Derivatives – under construction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="minimization-multidimensional-stub.html">
     6.2. Finding the Minimum of a Function of Several Variables — Coming Soon
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="ODE-IVPs.html">
   7. Initial Value Problems for Ordinary Differential Equations
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="ODE-IVP-0-background-examples.html">
     7.1. Background and Some Examples
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ODE-IVP-1-Euler.html">
     7.2. Euler’s Method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ODE-IVP-2-Runge-Kutta.html">
     7.3. Runge-Kutta Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ODE-IVP-3-error-results-one-step-methods.html">
     7.4. A Global Error Bound for One Step Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ODE-IVP-4-system-higher-order-equations.html">
     7.5. Systems of ODEs and Higher Order ODEs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ODE-IVP-5-error-control.html">
     7.6. Error Control and Variable Step Sizes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ODE-IVP-6-multi-step-methods-introduction.html">
     7.7. An Introduction to Multistep Methods
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     7.8. Adams-Bashforth Multistep Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ODE-IVP-8-implicit-methods-Adams-Moulton.html">
     7.9. Implicit Methods: Adams-Moulton
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bibliography.html">
   8. Bibliography
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="appendices.html">
   9. Appendices
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="installing-julia-and-packages.html">
     9.1. Installing Julia and some useful add-ons
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="julia-language-notes.html">
     9.2. Notes on the Julia Language
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="NumericalMethods.html">
     9.3. Module
     <code class="docutils literal notranslate">
      <span class="pre">
       NumericalMethods
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/ODE-IVP-7-multi-step-methods-Adams-Bashforth.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/docs/ODE-IVP-7-multi-step-methods-Adams-Bashforth.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#demonstrations-with-the-mass-spring-system">
     Demonstrations with the mass-spring system
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#this-time-with-damping-nothings-goes-wrong">
     This time with damping, nothings goes wrong!
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#higher-order-adams-bashforth-methods">
   Higher order Adams-Bashforth methods
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-1">
     Exercise 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-2">
     Exercise 2
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Adams-Bashforth Multistep Methods</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#demonstrations-with-the-mass-spring-system">
     Demonstrations with the mass-spring system
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#this-time-with-damping-nothings-goes-wrong">
     This time with damping, nothings goes wrong!
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#higher-order-adams-bashforth-methods">
   Higher order Adams-Bashforth methods
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-1">
     Exercise 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-2">
     Exercise 2
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="adams-bashforth-multistep-methods">
<h1><span class="section-number">7.8. </span>Adams-Bashforth Multistep Methods<a class="headerlink" href="#adams-bashforth-multistep-methods" title="Permalink to this headline">#</a></h1>
<p><strong>References:</strong></p>
<ul class="simple">
<li><p>Section 6.7 <em>Multistep Methods</em> in <span id="id1">[<a class="reference internal" href="bibliography.html#id4" title="Timothy Sauer. Numerical Analysis. Pearson, 3rd edition, 2019.">Sauer, 2019</a>]</span>.</p></li>
<li><p>Section 5.6 <em>Multistep Methods</em> in <span id="id2">[<a class="reference internal" href="bibliography.html#id5" title="Richard L. Burden, J. Douglas Faires, and Annette M. Burden. Numerical Analysis. Cengage, 10th edition, 2016.">Burden <em>et al.</em>, 2016</a>]</span>.</p></li>
</ul>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p>Recall from <a class="reference internal" href="ODE-IVP-6-multi-step-methods-introduction.html"><span class="doc">An Introduction to Multistep Methods</span></a>:</p>
<div class="proof definition admonition" id="multistep-method-redux">
<p class="admonition-title"><span class="caption-number">Definition 7.2 </span> (Multistep Method)</p>
<section class="definition-content" id="proof-content">
<p>A <strong>multistep method</strong> for numerical solution of an ODE IVP <span class="math notranslate nohighlight">\(du/dt = f(t, u)\)</span>, <span class="math notranslate nohighlight">\(u(t_0) = u_0\)</span> is one of the form</p>
<div class="math notranslate nohighlight">
\[ U_{i} = \phi(U_{i-1}, \dots U_{i-s}, h), \quad s &gt; 1 \]</div>
<p>so that the new approximate value of <span class="math notranslate nohighlight">\(u(t)\)</span> depends on approximate values at multiple previous times.
(The shift of indexing to describe “present” in terms of “past” wil be convenient here.)</p>
<p>This is called an <span class="math notranslate nohighlight">\(s\)</span>-step method: the Runge-Kutta family of methods are all one-step.</p>
</section>
</div><p>We will be more specifically interted in what are called <strong>linear multistep methods</strong>,
where the function at right is a linear combination of value of <span class="math notranslate nohighlight">\(u(t)\)</span> and <span class="math notranslate nohighlight">\(f(t, u(t))\)</span>.</p>
<p>So for now we look at</p>
<div class="math notranslate nohighlight">
\[U_{i} = a_0 U_{i-s} + \dots + a_{s-1} U_{i-1} + h (b_0 f(t_{i-s}, U_{i-s}) + \dots + b_{s-1} f(t_{i-1}, U_{i-1})) \]</div>
<p>The <strong>Adams-Bashforth</strong> methods are a case of this with the only <span class="math notranslate nohighlight">\(a_i\)</span> term being <span class="math notranslate nohighlight">\(a_{s-1} = 1\)</span>:</p>
<div class="math notranslate nohighlight">
\[U_{i} = U_{i-1} + h (b_0 f(t_{i-s}, U_{i-s}) + \dots + b_{s-1} f(t_{i-1}, U_{i-1})) \]</div>
<p>As wil be verified later, the <span class="math notranslate nohighlight">\(s\)</span>-step version of this is accurate to order <span class="math notranslate nohighlight">\(s\)</span>,
so one can get arbitrarily high order of accuracy by using enough steps.</p>
<p><strong>Aside.</strong> The case <span class="math notranslate nohighlight">\(s=1\)</span> is Euler’s method, now written as</p>
<div class="math notranslate nohighlight">
\[U_{i} = U_{i-1} + h f(t_{i-1}, U_{i-1})\]</div>
<p>The Adams-Bashforth methods are probably the most comomnly used <strong>explicit</strong>, <strong>one-stage</strong> multi-step methods;
we will see more about the alternatives of <strong>implicit</strong> and <strong>multi-stage</strong> options in future sections.
(Note that all Runge-Kutta methods (except Euler’s) are multi-stage: the explicit trapezoid and midpoint methods are 2-stage; the classical Runge-Kutta method is 4-stage.)</p>
<p>The most basic <strong>Adams-Bashforth</strong> multi-step method is the 2-step method, which can be thought of this way:</p>
<ol class="simple">
<li><p>Start with the two most recent values, <span class="math notranslate nohighlight">\(U_{i-1} \approx u(t_{i) - h}\)</span> and <span class="math notranslate nohighlight">\(U_{i-2} \approx u(t_i - 2h)\)</span></p></li>
<li><p>Use the derivative approximations
<span class="math notranslate nohighlight">\(F_{i-1} := f(t_{i-1}, U_{i-1}) \approx u'(t_{i-1})\)</span> and <span class="math notranslate nohighlight">\(F_{i-2} := f(t_{i-2}, U_{i-2}) \approx u'(t_{i-2})\)</span>
and linear extrapolation to “predict” the value of <span class="math notranslate nohighlight">\(u'(t_i - h/2)\)</span>; one gets:
<span class="math notranslate nohighlight">\(u'(t_i - h/2) \approx \frac{3}{2} u'(t_i - h) - \frac{1}{2}u'(t_i - 2h) \approx \frac{3}{2} F_{i-1} - \frac{1}{2}F_{i-2}\)</span></p></li>
<li><p>Use this in the centered difference approximation</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\frac{u(t_{i}) - u(t_{i-1})}{h} \approx u'(t_i - h/2)\]</div>
<p>to get</p>
<div class="math notranslate nohighlight">
\[\frac{U_{i} - U_{i-1}}{h} \approx \frac{3}{2} F_{i-1} - \frac{1}{2} F_{i-2}\]</div>
<p>That is,</p>
<div class="math notranslate nohighlight" id="equation-adams-bashforth-2">
<span class="eqno">(7.11)<a class="headerlink" href="#equation-adams-bashforth-2" title="Permalink to this equation">#</a></span>\[
U_{i} = U_{i-1} + \frac{h}{2} \left( 3 F_{i-1} - F_{i-2} \right), = U_{i-1} + \frac{h}{2} \left( 3 f(t_{i-1}, U_{i-1}) - f(t_{i-2}, U_{i-2}) \right)
\]</div>
<p>Equivalently, one can</p>
<ol class="simple">
<li><p>Find the collocating polynomial <span class="math notranslate nohighlight">\(p(t)\)</span> through <span class="math notranslate nohighlight">\((t_{i-1}, F_{i-1})\)</span> and <span class="math notranslate nohighlight">\((t_{i-2}, F_{i-2})\)</span> [so just a line in this case]</p></li>
<li><p>Use this on the interval <span class="math notranslate nohighlight">\((t_{i-1}, t_{i})\)</span> (<em>extrapolation</em>) as an approximation of <span class="math notranslate nohighlight">\(u'(t) = f(t, u(t))\)</span> in that interval.</p></li>
<li><p>Use</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\displaystyle u(t_{i}) = u(t_{i-1}) + \int_{t_{i-1}}^{t_{i}} u'(\tau) d \tau \approx u(t_{i-1}) + \int_{t_{i-1}}^{t_{i}} p(\tau) d \tau,\]</div>
<p>where the latter integral is easy to evaluate exactly.</p>
<p>One does not actually do this in each case; it is enough to verify that the integral gives
<span class="math notranslate nohighlight">\(\left( \frac{3}{2} F_{i-1} - \frac{1}{2} F_{i-2} \right) h\)</span>.</p>
<p>See <a class="reference external" href="#exercise-1">Exercise 1</a>.</p>
<p>To code this algorithm, it is convenient to shift the indices, to get a formula for <span class="math notranslate nohighlight">\(U_i\)</span>.
Also, note that what is <span class="math notranslate nohighlight">\(F_i = f(t_i, U_i)\)</span> at one step is reused as <span class="math notranslate nohighlight">\(F_{i-1} = f(t_{i-1}, U_{i-1})\)</span> at the next,
so to avoid redundant evaluations of <span class="math notranslate nohighlight">\(f(t, u)\)</span>, these quantities should also be saved, at least till the next step:</p>
<div class="math notranslate nohighlight">
\[U_{i} = U_{i-1} + \frac{h}{2} \left( 3 F_{i-1} - F_{i-2} \right)\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="n">PyPlot</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">include</span><span class="p">(</span><span class="s">&quot;NumericalMethods.jl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Main.NumericalMethods
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="o">.</span><span class="n">NumericalMethods</span> <span class="n">as</span> <span class="n">NM</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span> <span class="n">adamsbashforth2</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">U_0</span><span class="p">,</span> <span class="n">U_1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">n_unknowns</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">U_0</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">range</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_unknowns</span><span class="p">)</span>
    <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">:</span><span class="p">]</span> <span class="o">=</span> <span class="n">U_0</span>
    <span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="o">:</span><span class="p">]</span> <span class="o">=</span> <span class="n">U_1</span>
    <span class="n">F_i_2</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">U_0</span><span class="p">)</span>  <span class="c"># F_0 to start when computing U_2</span>
    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
    <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">2</span><span class="o">:</span><span class="n">n</span>  <span class="c"># i is the mathematical index, so &quot;+1&quot; for Julia array indices</span>
        <span class="n">F_i_1</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="o">:</span><span class="p">])</span>
        <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="o">:</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="o">:</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">F_i_1</span> <span class="o">-</span> <span class="n">F_i_2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">F_i_2</span> <span class="o">=</span> <span class="n">F_i_1</span>
    <span class="k">end</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
<span class="k">end</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<section id="demonstrations-with-the-mass-spring-system">
<h3>Demonstrations with the mass-spring system<a class="headerlink" href="#demonstrations-with-the-mass-spring-system" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">f_mass_spring</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span> <span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="o">-</span><span class="p">(</span><span class="n">K</span><span class="o">/</span><span class="n">M</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">D</span><span class="o">/</span><span class="n">M</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">];</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="o">.</span><span class="n">NumericalMethods</span><span class="o">:</span> <span class="n">y_mass_spring</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">K</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">D</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">y_0</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">v_0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">U_0</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_0</span><span class="p">,</span> <span class="n">v_0</span><span class="p">]</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">periods</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="nb">pi</span> <span class="o">*</span> <span class="n">periods</span>

<span class="c"># Using the same time step size as with the leapfrog method in the previous section.</span>
<span class="n">stepsperperiod</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n</span> <span class="o">=</span> <span class="kt">Int</span><span class="p">(</span><span class="n">stepsperperiod</span> <span class="o">*</span> <span class="n">periods</span><span class="p">)</span>

<span class="c"># We need U_1, and get it with the Runge-Kutta method;</span>
<span class="c"># this is overkill for accuracy, but since only one step is needed, the time cost is negligible.</span>
<span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
<span class="p">(</span><span class="n">t_1step</span><span class="p">,</span> <span class="n">U_1step</span><span class="p">)</span> <span class="o">=</span> <span class="n">NM</span><span class="o">.</span><span class="n">rungekutta_system</span><span class="p">(</span><span class="n">f_mass_spring</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="n">h</span><span class="p">,</span> <span class="n">U_0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">U_1</span> <span class="o">=</span> <span class="n">U_1step</span><span class="p">[</span><span class="k">end</span><span class="p">,</span><span class="o">:</span><span class="p">]</span>
<span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span> <span class="o">=</span> <span class="n">adamsbashforth2</span><span class="p">(</span><span class="n">f_mass_spring</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">U_0</span><span class="p">,</span> <span class="n">U_1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">DY</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y_mass_spring</span><span class="o">.</span><span class="p">(</span><span class="n">t</span><span class="p">;</span> <span class="n">t_0</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">u_0</span><span class="o">=</span><span class="n">U_0</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="n">D</span><span class="p">)</span>  <span class="c"># Exact solution</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;K/M=</span><span class="si">$</span><span class="p">(</span><span class="n">K</span><span class="o">/</span><span class="n">M</span><span class="p">)</span><span class="s">, D=</span><span class="si">$D</span><span class="s"> by 2-step Adams-Bashforth with </span><span class="si">$periods</span><span class="s"> periods, </span><span class="si">$stepsperperiod</span><span class="s"> steps per period&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;y computed&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;exact solution&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;t&quot;</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;y&quot;</span><span class="p">)</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;Error in Y&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="n">Y</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;t&quot;</span><span class="p">)</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mf">5.5</span><span class="p">])</span>  <span class="c"># Make axes equal length; orbits should be circular or &quot;circular spirals&quot;</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;The orbit&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">DY</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;y&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">DY</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&quot;g*&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;start&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="k">end</span><span class="p">],</span> <span class="n">DY</span><span class="p">[</span><span class="k">end</span><span class="p">],</span> <span class="s">&quot;r*&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;end&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_20_0.png" src="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_20_0.png" />
<img alt="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_20_1.png" src="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_20_1.png" />
<img alt="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_20_2.png" src="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_20_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="n">periods</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="nb">pi</span> <span class="o">*</span> <span class="n">periods</span>

<span class="c"># Using the same time step size as with the leapfrog method in the previous section.</span>
<span class="n">stepsperperiod</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n</span> <span class="o">=</span> <span class="kt">Int</span><span class="p">(</span><span class="n">stepsperperiod</span> <span class="o">*</span> <span class="n">periods</span><span class="p">)</span>

<span class="c"># We need U_1, and get it with the Runge-Kutta method;</span>
<span class="c"># this is overkill for accuracy, but since only one step is needed, the time cost is negligible.</span>
<span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
<span class="p">(</span><span class="n">t_1step</span><span class="p">,</span> <span class="n">U_1step</span><span class="p">)</span> <span class="o">=</span> <span class="n">NM</span><span class="o">.</span><span class="n">rungekutta_system</span><span class="p">(</span><span class="n">f_mass_spring</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="n">h</span><span class="p">,</span> <span class="n">U_0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">U_1</span> <span class="o">=</span> <span class="n">U_1step</span><span class="p">[</span><span class="k">end</span><span class="p">,</span><span class="o">:</span><span class="p">]</span>
<span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span> <span class="o">=</span> <span class="n">adamsbashforth2</span><span class="p">(</span><span class="n">f_mass_spring</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">U_0</span><span class="p">,</span> <span class="n">U_1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">DY</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y_mass_spring</span><span class="o">.</span><span class="p">(</span><span class="n">t</span><span class="p">;</span> <span class="n">t_0</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">u_0</span><span class="o">=</span><span class="n">U_0</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="n">D</span><span class="p">)</span>  <span class="c"># Exact solution</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;K/M=</span><span class="si">$</span><span class="p">(</span><span class="n">K</span><span class="o">/</span><span class="n">M</span><span class="p">)</span><span class="s">, D=</span><span class="si">$D</span><span class="s"> by 2-step Adams-Bashforth with </span><span class="si">$periods</span><span class="s"> periods, </span><span class="si">$stepsperperiod</span><span class="s"> steps per period&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;y computed&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;exact solution&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;t&quot;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;y&quot;</span><span class="p">)</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;Error in Y&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="n">Y</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;t&quot;</span><span class="p">)</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mf">5.5</span><span class="p">])</span>  <span class="c"># Make axes equal length; orbits should be circular or &quot;circular spirals&quot;</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;The orbits&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">DY</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;y&quot;</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;dy/dt&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">DY</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&quot;g*&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;start&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="k">end</span><span class="p">],</span> <span class="n">DY</span><span class="p">[</span><span class="k">end</span><span class="p">],</span> <span class="s">&quot;r*&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;end&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_21_0.png" src="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_21_0.png" />
<img alt="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_21_1.png" src="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_21_1.png" />
<img alt="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_21_2.png" src="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_21_2.png" />
</div>
</div>
<p>In comparison to the (also second order accurate) leap-frog method, this is distinctly worse;
the errors are more than twice as large, and the solution fails to stay on the circle;
unlike leapfrog, the energy <span class="math notranslate nohighlight">\(E(t) = \frac{1}{2}(y^2(t) + Dy^2(t))\)</span> is not conserved.</p>
<p>On the other hand …</p>
</section>
<section id="this-time-with-damping-nothings-goes-wrong">
<h3>This time with damping, nothings goes wrong!<a class="headerlink" href="#this-time-with-damping-nothings-goes-wrong" title="Permalink to this headline">#</a></h3>
<p>This is an example in <strong>stability</strong>;
in future sections it will be seen that the the Adams-Bashforth methods are all stable for these equations for small enough step size <span class="math notranslate nohighlight">\(h\)</span>,
and so converge to the correct solution as <span class="math notranslate nohighlight">\(h \to 0\)</span>.</p>
<p>Looking back, this suggests (correctly) that while the leapfrog method is well-suited to <em>conservative</em> equations, Adams-Bashforth methods are much preferable for more general equations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">periods</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="nb">pi</span> <span class="o">*</span> <span class="n">periods</span>

<span class="c"># Using the same time step size as with the leapfrog method in the previous section.</span>
<span class="n">stepsperperiod</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n</span> <span class="o">=</span> <span class="kt">Int</span><span class="p">(</span><span class="n">stepsperperiod</span> <span class="o">*</span> <span class="n">periods</span><span class="p">)</span>

<span class="c"># We need U_1, and get it with the Runge-Kutta method;</span>
<span class="c"># this is overkill for accuracy, but since only one step is needed, the time cost is negligible.</span>
<span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
<span class="p">(</span><span class="n">t_1step</span><span class="p">,</span> <span class="n">U_1step</span><span class="p">)</span> <span class="o">=</span> <span class="n">NM</span><span class="o">.</span><span class="n">rungekutta_system</span><span class="p">(</span><span class="n">f_mass_spring</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="n">h</span><span class="p">,</span> <span class="n">U_0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">U_1</span> <span class="o">=</span> <span class="n">U_1step</span><span class="p">[</span><span class="k">end</span><span class="p">,</span><span class="o">:</span><span class="p">]</span>
<span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span> <span class="o">=</span> <span class="n">adamsbashforth2</span><span class="p">(</span><span class="n">f_mass_spring</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">U_0</span><span class="p">,</span> <span class="n">U_1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">DY</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y_mass_spring</span><span class="o">.</span><span class="p">(</span><span class="n">t</span><span class="p">;</span> <span class="n">t_0</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">u_0</span><span class="o">=</span><span class="n">U_0</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="n">D</span><span class="p">)</span>  <span class="c"># Exact solution</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;K/M=</span><span class="si">$</span><span class="p">(</span><span class="n">K</span><span class="o">/</span><span class="n">M</span><span class="p">)</span><span class="s">, D=</span><span class="si">$D</span><span class="s"> by 2-step Adams-Bashforth with </span><span class="si">$periods</span><span class="s"> periods, </span><span class="si">$stepsperperiod</span><span class="s"> steps per period&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;y computed&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;exact solution&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;t&quot;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;y&quot;</span><span class="p">)</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;Error in Y&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="n">Y</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;t&quot;</span><span class="p">)</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_24_0.png" src="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_24_0.png" />
<img alt="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_24_1.png" src="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_24_1.png" />
</div>
</div>
</section>
</section>
<section id="higher-order-adams-bashforth-methods">
<h2>Higher order Adams-Bashforth methods<a class="headerlink" href="#higher-order-adams-bashforth-methods" title="Permalink to this headline">#</a></h2>
<p>The strategy described above of polynomial approximation, extrapolation, and integration can be generalized to get the <span class="math notranslate nohighlight">\(s\)</span> step Adams-Bashforth method, of order <span class="math notranslate nohighlight">\(s\)</span>;
to get the approximation <span class="math notranslate nohighlight">\(U_i\)</span> of <span class="math notranslate nohighlight">\(u(t_i)\)</span> from data at the <span class="math notranslate nohighlight">\(s\)</span> most recent previous times <span class="math notranslate nohighlight">\(t_{i-1}\)</span> to <span class="math notranslate nohighlight">\(t_{i-s}\)</span>:</p>
<ol class="simple">
<li><p>Find the collocating polynomial <span class="math notranslate nohighlight">\(p(t)\)</span> of degree <span class="math notranslate nohighlight">\(s-1\)</span> through
<span class="math notranslate nohighlight">\((t_{i-1}, F_{i-1}) \dots (t_{i-s}, F_{i-s})\)</span></p></li>
<li><p>Use this on the interval <span class="math notranslate nohighlight">\((t_{i-1}, t_{i})\)</span> (<em>extrapolation</em>) as an approximation of <span class="math notranslate nohighlight">\(u'(t) = f(t, u(t))\)</span> in that interval.</p></li>
<li><p>Use <span class="math notranslate nohighlight">\(u(t_{i}) = u(t_{i-1}) + \int_{t_{i-1}}^{t_{i}} u'(\tau) d \tau \approx u(t_{i-1}) + \int_{t_{i-1}}^{t_{i}} p(\tau) d\tau\)</span>,
where the latter integral can be evaluated exactly.</p></li>
</ol>
<p>Again, one does not actually evaluate this integral; it is enough to verify that the resulting form will be</p>
<div class="math notranslate nohighlight">
\[U_{i} = U_{i-1} + h (b_0 F_{i-s} + b_1 F_{i-s+1} + \cdots b_{s-1} F_{i-1})\]</div>
<p>with the coefficients being the same for any <span class="math notranslate nohighlight">\(f(t, u)\)</span> and any <span class="math notranslate nohighlight">\(h\)</span>.</p>
<p>In fact, the polynomial fitting and integration can be skipped: thecoefficients can be derived by the method of undetermined coefficients as seen in
<a class="reference internal" href="derivatives-and-the-method-of-undetermined-coefficents.html"><span class="doc">Approximating Derivatives by the Method of Undetermined Coefficients</span></a>
and this also established that the local truncation error is <span class="math notranslate nohighlight">\(O(h^s)\)</span>:</p>
<ul class="simple">
<li><p>insert Taylor polynomial approximations of
<span class="math notranslate nohighlight">\(u(t_{i-k}) = u(t_i) - k h)\)</span> and
<span class="math notranslate nohighlight">\(f(t_{i-k}, u(t_{i-k})) = u'(t_{i-k}) = u'(t_i - k h)\)</span>
into
$<span class="math notranslate nohighlight">\(U_{i} = U_{i-1} + h (b_0 f(t_{i-s}, U_{i-s}) + \dots + b_{s-1} f(t_{i-1}, U_{i-1})) \)</span>$</p></li>
<li><p>solve for the <span class="math notranslate nohighlight">\(s\)</span> coefficients <span class="math notranslate nohighlight">\(b_0 \dots b_{s-1}\)</span> that give the highest power for the residual error:
the terms in the first <span class="math notranslate nohighlight">\(s\)</span> powers of <span class="math notranslate nohighlight">\(h\)</span> (from <span class="math notranslate nohighlight">\(h^0 = 1\)</span> to <span class="math notranslate nohighlight">\(h^{s-1}\)</span>) can be cancelled, leaving an error <span class="math notranslate nohighlight">\(O(h^s)\)</span>.</p></li>
</ul>
<p>The first few Adams-Bashforth formulas are:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(s=1\)</span>: <span class="math notranslate nohighlight">\(b_0 = 1\)</span>,
$<span class="math notranslate nohighlight">\(U_{i} = U_{i-1} + h F_{i-1} = U_{i-1} + h f(t_{i-1}, U_{i-1}) \quad \text{(Euler's method)}\)</span>$</p></li>
<li><p><span class="math notranslate nohighlight">\(s=2\)</span>: <span class="math notranslate nohighlight">\(b_0 = -1/2, b_1 = 3/2\)</span>,
$<span class="math notranslate nohighlight">\(U_{i} = U_{i-1} + \frac{h}{2} \left( 3 F_{i-1} - F_{i-2} \right) \quad \text{(as above)}\)</span>$</p></li>
<li><p><span class="math notranslate nohighlight">\(s=3\)</span>: <span class="math notranslate nohighlight">\(b_0 = 5/12, b_1 = -16/12, b_2 = 23/12\)</span>,
$<span class="math notranslate nohighlight">\(U_{i} = U_{i-1} + \frac{h}{12} \left( 23 F_{i-1} - 16F_{i-2} + 5 F_{i-3} \right)\)</span>$</p></li>
<li><p><span class="math notranslate nohighlight">\(s=4\)</span>: <span class="math notranslate nohighlight">\(b_0 = -9/24, b_1 = 37/24, b_2 = -59/24, b_3 = 55/24\)</span>,
$<span class="math notranslate nohighlight">\(U_{i} = U_{i-1} + \frac{h}{24} \left( 55 F_{i-1} - 59 F_{i-2} + 37 F_{i-3} -9 F_{i-4} \right)\)</span>$</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span> <span class="n">adamsbashforth3</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">U_0</span><span class="p">,</span> <span class="n">U_1</span><span class="p">,</span> <span class="n">U_2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">n_unknowns</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">U_0</span><span class="p">)</span>
    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">range</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_unknowns</span><span class="p">)</span>
    <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">:</span><span class="p">]</span> <span class="o">=</span> <span class="n">U_0</span>
    <span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="o">:</span><span class="p">]</span> <span class="o">=</span> <span class="n">U_1</span>
    <span class="n">u</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="o">:</span><span class="p">]</span> <span class="o">=</span> <span class="n">U_2</span>
    <span class="n">F_i_3</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">U_0</span><span class="p">)</span>  <span class="c"># F_0 to start when computing U_3</span>
    <span class="n">F_i_2</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">h</span><span class="p">,</span> <span class="n">U_1</span><span class="p">)</span>  <span class="c"># F_1 to start when computing U_3</span>
    <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">3</span><span class="o">:</span><span class="n">n</span>  <span class="c"># i is the mathematical index, so &quot;+1&quot; for Julia array indices</span>
        <span class="n">F_i_1</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="o">:</span><span class="p">])</span>
        <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="o">:</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="o">:</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">23</span><span class="n">F_i_1</span> <span class="o">-</span> <span class="mi">16</span><span class="n">F_i_2</span> <span class="o">+</span> <span class="mi">5</span><span class="n">F_i_3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">12</span><span class="p">)</span>
        <span class="p">(</span><span class="n">F_i_2</span><span class="p">,</span> <span class="n">F_i_3</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">F_i_1</span><span class="p">,</span> <span class="n">F_i_2</span><span class="p">)</span>
    <span class="k">end</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
<span class="k">end</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="n">periods</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="nb">pi</span> <span class="o">*</span> <span class="n">periods</span>

<span class="c"># Using the same time step size as for leapfrog method in the previous section.</span>
<span class="n">stepsperperiod</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n</span> <span class="o">=</span> <span class="kt">Int</span><span class="p">(</span><span class="n">stepsperperiod</span> <span class="o">*</span> <span class="n">periods</span><span class="p">)</span>

<span class="c"># We need U_1 and U_2, and get them with the Runge-Kutta method;</span>
<span class="c"># this is overkill for accuracy, but since only two steps are needed, the time cost is negligible.</span>
<span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
<span class="p">(</span><span class="n">t_2step</span><span class="p">,</span> <span class="n">U_2step</span><span class="p">)</span> <span class="o">=</span> <span class="n">NM</span><span class="o">.</span><span class="n">rungekutta_system</span><span class="p">(</span><span class="n">f_mass_spring</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="n">h</span><span class="p">,</span> <span class="n">U_0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">U_1</span> <span class="o">=</span> <span class="n">U_2step</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="o">:</span><span class="p">]</span>
<span class="n">U_2</span> <span class="o">=</span> <span class="n">U_2step</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="o">:</span><span class="p">]</span>
<span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span> <span class="o">=</span> <span class="n">adamsbashforth3</span><span class="p">(</span><span class="n">f_mass_spring</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">U_0</span><span class="p">,</span> <span class="n">U_1</span><span class="p">,</span><span class="n">U_2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">DY</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y_mass_spring</span><span class="o">.</span><span class="p">(</span><span class="n">t</span><span class="p">;</span> <span class="n">t_0</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">u_0</span><span class="o">=</span><span class="n">U_0</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="n">D</span><span class="p">)</span>  <span class="c"># Exact solution</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;K/M=</span><span class="si">$</span><span class="p">(</span><span class="n">K</span><span class="o">/</span><span class="n">M</span><span class="p">)</span><span class="s">, D=</span><span class="si">$D</span><span class="s"> by 3-step Adams-Bashforth with </span><span class="si">$periods</span><span class="s"> periods, </span><span class="si">$stepsperperiod</span><span class="s"> steps per period&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;y computed&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;exact solution&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;t&quot;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;y&quot;</span><span class="p">)</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;Error in Y&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="n">Y</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;t&quot;</span><span class="p">)</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mf">5.5</span><span class="p">])</span>  <span class="c"># Make axes equal length; orbits should be circular or &quot;circular spirals&quot;</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;The orbit&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">DY</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;y&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">DY</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&quot;g*&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;start&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="k">end</span><span class="p">],</span> <span class="n">DY</span><span class="p">[</span><span class="k">end</span><span class="p">],</span> <span class="s">&quot;r*&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;end&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_28_0.png" src="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_28_0.png" />
<img alt="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_28_1.png" src="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_28_1.png" />
<img alt="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_28_2.png" src="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_28_2.png" />
</div>
</div>
<p>Comparing to the leap-frog method, this higher order method at last has smaller errors (and they can be got even smaller by increasing the number of steps)
but the leapfrog method is still better at keeping the solutions on the circle.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">periods</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="nb">pi</span> <span class="o">*</span> <span class="n">periods</span>

<span class="c"># Note: In the notes on systems, the second order Runge-Kutta methods were tested with 50 steps per period</span>
<span class="c">#stepsperperiod = 50  # As for the second order accurate explicit trapezoid and midpoint methods</span>
<span class="n">stepsperperiod</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c"># Equal cost per unit time as for the explicit trapezoid and midpoint and Runge-Kutta methods</span>
<span class="n">n</span> <span class="o">=</span> <span class="kt">Int</span><span class="p">(</span><span class="n">stepsperperiod</span> <span class="o">*</span> <span class="n">periods</span><span class="p">)</span>

<span class="c"># We need U_1 and U_2, and get them with the Runge-Kutta method;</span>
<span class="c"># this is overkill for accuracy, but since only two steps are needed, the time cost is negligible.</span>
<span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
<span class="p">(</span><span class="n">t_2step</span><span class="p">,</span> <span class="n">U_2step</span><span class="p">)</span> <span class="o">=</span> <span class="n">NM</span><span class="o">.</span><span class="n">rungekutta_system</span><span class="p">(</span><span class="n">f_mass_spring</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="n">h</span><span class="p">,</span> <span class="n">U_0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">U_1</span> <span class="o">=</span> <span class="n">U_2step</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="o">:</span><span class="p">]</span>
<span class="n">U_2</span> <span class="o">=</span> <span class="n">U_2step</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="o">:</span><span class="p">]</span>
<span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span> <span class="o">=</span> <span class="n">adamsbashforth3</span><span class="p">(</span><span class="n">f_mass_spring</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">U_0</span><span class="p">,</span> <span class="n">U_1</span><span class="p">,</span><span class="n">U_2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">DY</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y_mass_spring</span><span class="o">.</span><span class="p">(</span><span class="n">t</span><span class="p">;</span> <span class="n">t_0</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">u_0</span><span class="o">=</span><span class="n">U_0</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="n">D</span><span class="p">)</span>  <span class="c"># Exact solution</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;K/M=</span><span class="si">$</span><span class="p">(</span><span class="n">K</span><span class="o">/</span><span class="n">M</span><span class="p">)</span><span class="s">, D=</span><span class="si">$D</span><span class="s"> by 3-step Adams-Bashforth with </span><span class="si">$periods</span><span class="s"> periods, </span><span class="si">$stepsperperiod</span><span class="s"> steps per period&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;y computed&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;exact solution&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;t&quot;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;y&quot;</span><span class="p">)</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;Error in Y&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="n">Y</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;t&quot;</span><span class="p">)</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_30_0.png" src="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_30_0.png" />
<img alt="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_30_1.png" src="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_30_1.png" />
</div>
</div>
<p>The fourth-order, four step method does at last appear to surpass leap-frog on the conservative case:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span> <span class="n">adamsbashforth4</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">U_0</span><span class="p">,</span> <span class="n">U_1</span><span class="p">,</span> <span class="n">U_2</span><span class="p">,</span> <span class="n">U_3</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">n_unknowns</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">U_0</span><span class="p">)</span>
    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">range</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_unknowns</span><span class="p">)</span>
    <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">:</span><span class="p">]</span> <span class="o">=</span> <span class="n">U_0</span>
    <span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="o">:</span><span class="p">]</span> <span class="o">=</span> <span class="n">U_1</span>
    <span class="n">u</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="o">:</span><span class="p">]</span> <span class="o">=</span> <span class="n">U_2</span>
    <span class="n">u</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="o">:</span><span class="p">]</span> <span class="o">=</span> <span class="n">U_3</span>
    <span class="n">F_i_4</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">U_0</span><span class="p">)</span>  <span class="c"># F_0 to start when computing U_4</span>
    <span class="n">F_i_3</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">h</span><span class="p">,</span> <span class="n">U_1</span><span class="p">)</span>  <span class="c"># F_1 to start when computing U_4</span>
    <span class="n">F_i_2</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="n">h</span><span class="p">,</span> <span class="n">U_2</span><span class="p">)</span>  <span class="c"># F_1 to start when computing U_4</span>
    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
    <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">4</span><span class="o">:</span><span class="n">n</span>  <span class="c"># i is the mathematical index, so &quot;+1&quot; for Julia array indices</span>
        <span class="n">F_i_1</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="o">:</span><span class="p">])</span>
        <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="o">:</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="o">:</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">55</span><span class="n">F_i_1</span> <span class="o">-</span> <span class="mi">59</span><span class="n">F_i_2</span> <span class="o">+</span> <span class="mi">37</span><span class="n">F_i_3</span> <span class="o">-</span> <span class="mi">9</span><span class="n">F_i_4</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">24</span><span class="p">)</span>
        <span class="p">(</span><span class="n">F_i_2</span><span class="p">,</span> <span class="n">F_i_3</span><span class="p">,</span> <span class="n">F_i_4</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">F_i_1</span><span class="p">,</span> <span class="n">F_i_2</span><span class="p">,</span> <span class="n">F_i_3</span><span class="p">)</span>
    <span class="k">end</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
<span class="k">end</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="n">periods</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="nb">pi</span> <span class="o">*</span> <span class="n">periods</span>

<span class="c"># Using the same time step size as for leapfrog method in the previous section.</span>
<span class="n">stepsperperiod</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n</span> <span class="o">=</span> <span class="kt">Int</span><span class="p">(</span><span class="n">stepsperperiod</span> <span class="o">*</span> <span class="n">periods</span><span class="p">)</span>

<span class="c"># We need U_1, U_2 and U_3, and get them with the Runge-Kutta method;</span>
<span class="c"># this is overkill for accuracy, but since only three steps are needed, the time cost is negligible.</span>
<span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
<span class="p">(</span><span class="n">t_3step</span><span class="p">,</span> <span class="n">U_3step</span><span class="p">)</span> <span class="o">=</span> <span class="n">NM</span><span class="o">.</span><span class="n">rungekutta_system</span><span class="p">(</span><span class="n">f_mass_spring</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">3</span><span class="n">h</span><span class="p">,</span> <span class="n">U_0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">U_1</span> <span class="o">=</span> <span class="n">U_3step</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="o">:</span><span class="p">]</span>
<span class="n">U_2</span> <span class="o">=</span> <span class="n">U_3step</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="o">:</span><span class="p">]</span>
<span class="n">U_3</span> <span class="o">=</span> <span class="n">U_3step</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="o">:</span><span class="p">]</span>
<span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span> <span class="o">=</span> <span class="n">adamsbashforth4</span><span class="p">(</span><span class="n">f_mass_spring</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">U_0</span><span class="p">,</span> <span class="n">U_1</span><span class="p">,</span> <span class="n">U_2</span><span class="p">,</span> <span class="n">U_3</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">DY</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y_mass_spring</span><span class="o">.</span><span class="p">(</span><span class="n">t</span><span class="p">;</span> <span class="n">t_0</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">u_0</span><span class="o">=</span><span class="n">U_0</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="n">D</span><span class="p">)</span>  <span class="c"># Exact solution</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;K/M=</span><span class="si">$</span><span class="p">(</span><span class="n">K</span><span class="o">/</span><span class="n">M</span><span class="p">)</span><span class="s">, D=</span><span class="si">$D</span><span class="s"> by 4-step Adams-Bashforth with </span><span class="si">$periods</span><span class="s"> periods, </span><span class="si">$stepsperperiod</span><span class="s"> steps per period&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;y computed&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;exact solution&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;t&quot;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;y&quot;</span><span class="p">)</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;Error in Y&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="n">Y</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;t&quot;</span><span class="p">)</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mf">5.5</span><span class="p">])</span>  <span class="c"># Make axes equal length; orbits should be circular or &quot;circular spirals&quot;</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;The orbit&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">DY</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;y&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">DY</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&quot;g*&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;start&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="k">end</span><span class="p">],</span> <span class="n">DY</span><span class="p">[</span><span class="k">end</span><span class="p">],</span> <span class="s">&quot;r*&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;end&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_33_0.png" src="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_33_0.png" />
<img alt="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_33_1.png" src="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_33_1.png" />
<img alt="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_33_2.png" src="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_33_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">periods</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="nb">pi</span> <span class="o">*</span> <span class="n">periods</span>

<span class="c"># Using the same time step size as for leapfrog method in the previous section.</span>
<span class="n">stepsperperiod</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">n</span> <span class="o">=</span> <span class="kt">Int</span><span class="p">(</span><span class="n">stepsperperiod</span> <span class="o">*</span> <span class="n">periods</span><span class="p">)</span>

<span class="c"># We need U_1, U_2 and U_3, and get them with the Runge-Kutta method.</span>
<span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
<span class="p">(</span><span class="n">t_3step</span><span class="p">,</span> <span class="n">U_3step</span><span class="p">)</span> <span class="o">=</span> <span class="n">NM</span><span class="o">.</span><span class="n">rungekutta_system</span><span class="p">(</span><span class="n">f_mass_spring</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">3</span><span class="n">h</span><span class="p">,</span> <span class="n">U_0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">U_1</span> <span class="o">=</span> <span class="n">U_3step</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="o">:</span><span class="p">]</span>
<span class="n">U_2</span> <span class="o">=</span> <span class="n">U_3step</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="o">:</span><span class="p">]</span>
<span class="n">U_3</span> <span class="o">=</span> <span class="n">U_3step</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="o">:</span><span class="p">]</span>
<span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span> <span class="o">=</span> <span class="n">adamsbashforth4</span><span class="p">(</span><span class="n">f_mass_spring</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">U_0</span><span class="p">,</span> <span class="n">U_1</span><span class="p">,</span> <span class="n">U_2</span><span class="p">,</span> <span class="n">U_3</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">DY</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y_mass_spring</span><span class="o">.</span><span class="p">(</span><span class="n">t</span><span class="p">;</span> <span class="n">t_0</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">u_0</span><span class="o">=</span><span class="n">U_0</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="n">D</span><span class="p">)</span>  <span class="c"># Exact solution</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;K/M=</span><span class="si">$</span><span class="p">(</span><span class="n">K</span><span class="o">/</span><span class="n">M</span><span class="p">)</span><span class="s">, D=</span><span class="si">$D</span><span class="s"> by 4-step Adams-Bashforth with </span><span class="si">$periods</span><span class="s"> periods, </span><span class="si">$stepsperperiod</span><span class="s"> steps per period&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;y computed&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;exact solution&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;t&quot;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;y&quot;</span><span class="p">)</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;Error in Y&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="n">Y</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;t&quot;</span><span class="p">)</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_34_0.png" src="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_34_0.png" />
<img alt="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_34_1.png" src="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_34_1.png" />
</div>
</div>
<p>Finally, an “equal cost” comparison to the forht order Runge-Kutta method results in section
<a class="reference internal" href="ODE-IVP-4-system-higher-order-equations.html"><span class="doc">Systems of ODEs and Higher Order ODEs</span></a>
with four times as many steps per unit time: the fourth order Adams-Bashforth method come out ahead in these two test cases.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="n">periods</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="nb">pi</span> <span class="o">*</span> <span class="n">periods</span>

<span class="n">stepsperperiod</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n</span> <span class="o">=</span> <span class="kt">Int</span><span class="p">(</span><span class="n">stepsperperiod</span> <span class="o">*</span> <span class="n">periods</span><span class="p">)</span>

<span class="c"># We need U_1, U_2 and U_3, and get them with the Runge-Kutta method;</span>
<span class="c"># this is overkill for accuracy, but since only three steps are needed, the time cost is negligible.</span>
<span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
<span class="p">(</span><span class="n">t_3step</span><span class="p">,</span> <span class="n">U_3step</span><span class="p">)</span> <span class="o">=</span> <span class="n">NM</span><span class="o">.</span><span class="n">rungekutta_system</span><span class="p">(</span><span class="n">f_mass_spring</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">3</span><span class="n">h</span><span class="p">,</span> <span class="n">U_0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">U_1</span> <span class="o">=</span> <span class="n">U_3step</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="o">:</span><span class="p">]</span>
<span class="n">U_2</span> <span class="o">=</span> <span class="n">U_3step</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="o">:</span><span class="p">]</span>
<span class="n">U_3</span> <span class="o">=</span> <span class="n">U_3step</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="o">:</span><span class="p">]</span>
<span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span> <span class="o">=</span> <span class="n">adamsbashforth4</span><span class="p">(</span><span class="n">f_mass_spring</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">U_0</span><span class="p">,</span> <span class="n">U_1</span><span class="p">,</span> <span class="n">U_2</span><span class="p">,</span> <span class="n">U_3</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">DY</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y_mass_spring</span><span class="o">.</span><span class="p">(</span><span class="n">t</span><span class="p">;</span> <span class="n">t_0</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">u_0</span><span class="o">=</span><span class="n">U_0</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="n">D</span><span class="p">)</span>  <span class="c"># Exact solution</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;K/M=</span><span class="si">$</span><span class="p">(</span><span class="n">K</span><span class="o">/</span><span class="n">M</span><span class="p">)</span><span class="s">, D=</span><span class="si">$D</span><span class="s"> by 4-step Adams-Bashforth with </span><span class="si">$periods</span><span class="s"> periods, </span><span class="si">$stepsperperiod</span><span class="s"> steps per period&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;y computed&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;exact solution&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;t&quot;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;y&quot;</span><span class="p">)</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;Error in Y&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="n">Y</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;t&quot;</span><span class="p">)</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mf">5.5</span><span class="p">])</span>  <span class="c"># Make axes equal length; orbits should be circular or &quot;circular spirals&quot;</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;The orbit&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">DY</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;y&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">DY</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&quot;g*&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;start&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="k">end</span><span class="p">],</span> <span class="n">DY</span><span class="p">[</span><span class="k">end</span><span class="p">],</span> <span class="s">&quot;r*&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;end&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_36_0.png" src="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_36_0.png" />
<img alt="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_36_1.png" src="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_36_1.png" />
<img alt="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_36_2.png" src="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_36_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">periods</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="nb">pi</span> <span class="o">*</span> <span class="n">periods</span>

<span class="c"># Using the same time step size as for leapfrog method in the previous section.</span>
<span class="n">stepsperperiod</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n</span> <span class="o">=</span> <span class="kt">Int</span><span class="p">(</span><span class="n">stepsperperiod</span> <span class="o">*</span> <span class="n">periods</span><span class="p">)</span>

<span class="c"># We need U_1, U_2 and U_3, and get them with the Runge-Kutta method;</span>
<span class="c"># this is overkill for accuracy, but since only three steps are needed, the time cost is negligible.</span>
<span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
<span class="p">(</span><span class="n">t_3step</span><span class="p">,</span> <span class="n">U_3step</span><span class="p">)</span> <span class="o">=</span> <span class="n">NM</span><span class="o">.</span><span class="n">rungekutta_system</span><span class="p">(</span><span class="n">f_mass_spring</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">3</span><span class="n">h</span><span class="p">,</span> <span class="n">U_0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">U_1</span> <span class="o">=</span> <span class="n">U_3step</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="o">:</span><span class="p">]</span>
<span class="n">U_2</span> <span class="o">=</span> <span class="n">U_3step</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="o">:</span><span class="p">]</span>
<span class="n">U_3</span> <span class="o">=</span> <span class="n">U_3step</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="o">:</span><span class="p">]</span>
<span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span> <span class="o">=</span> <span class="n">adamsbashforth4</span><span class="p">(</span><span class="n">f_mass_spring</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">U_0</span><span class="p">,</span> <span class="n">U_1</span><span class="p">,</span> <span class="n">U_2</span><span class="p">,</span> <span class="n">U_3</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">DY</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y_mass_spring</span><span class="o">.</span><span class="p">(</span><span class="n">t</span><span class="p">;</span> <span class="n">t_0</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">u_0</span><span class="o">=</span><span class="n">U_0</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="n">D</span><span class="p">)</span>  <span class="c"># Exact solution</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;K/M=</span><span class="si">$</span><span class="p">(</span><span class="n">K</span><span class="o">/</span><span class="n">M</span><span class="p">)</span><span class="s">, D=</span><span class="si">$D</span><span class="s"> by 4-step Adams-Bashforth with </span><span class="si">$periods</span><span class="s"> periods, </span><span class="si">$stepsperperiod</span><span class="s"> steps per period&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;y computed&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;exact solution&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;t&quot;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;y&quot;</span><span class="p">)</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s">&quot;Error in Y&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="n">Y</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;t&quot;</span><span class="p">)</span>
<span class="n">grid</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_37_0.png" src="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_37_0.png" />
<img alt="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_37_1.png" src="../_images/ODE-IVP-7-multi-step-methods-Adams-Bashforth_37_1.png" />
</div>
</div>
</section>
<hr class="docutils" />
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">#</a></h2>
<p><a name="exercise-1"></a></p>
<section id="exercise-1">
<h3>Exercise 1<a class="headerlink" href="#exercise-1" title="Permalink to this headline">#</a></h3>
<p>Verify the derivation of Equation <a class="reference internal" href="#equation-adams-bashforth-2">(7.11)</a> for the second order Adams-Bashforth method, via polynomial collocation and integration.</p>
<p><a name="exercise-3"></a></p>
</section>
<section id="exercise-2">
<h3>Exercise 2<a class="headerlink" href="#exercise-2" title="Permalink to this headline">#</a></h3>
<p>Verify the above result for <span class="math notranslate nohighlight">\(s=3\)</span> by the method of undetermined coefficients.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "julia-1.8"
        },
        kernelOptions: {
            kernelName: "julia-1.8",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'julia-1.8'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="ODE-IVP-6-multi-step-methods-introduction.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">7.7. </span>An Introduction to Multistep Methods</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="ODE-IVP-8-implicit-methods-Adams-Moulton.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">7.9. </span>Implicit Methods: Adams-Moulton</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Brenton LeMesurier (College of Charleston, South Carolina) with contributions from Stephen Roberts (Australian National University).<br/>
  
      &copy; Copyright 2021–2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>